@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

@{

    ViewData["Title"] = "My Basket";

}

@section Styles {
    <link href="~/css/MyBasket.css" rel="stylesheet" asp-append-version="true" />
}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<div class="basket-container" id="fullBasketView" style="display: none;">
    <div class="basket-left" id="basketItems"></div>

    <div class="basket-right">
        <h4>🛒 Cart Summary</h4>
        <div id="summaryItems"></div>
        <hr>
        <h5>Total: ₹<span id="totalAmount">0</span></h5>



    </div>
</div>

@section Scripts {
    <script>

                document.addEventListener("DOMContentLoaded", () => {

                    const fullBasketView = document.getElementById("fullBasketView");

                    const basketItems = document.getElementById("basketItems");

                    const summaryItems = document.getElementById("summaryItems");

                    const totalAmount = document.getElementById("totalAmount");

                    let cart = JSON.parse(localStorage.getItem("myCart")) || [];

                    if (cart.length > 0) {

                        fullBasketView.style.display = "flex";

                        let total = 0;

                        cart.forEach(item => {

                            let itemTotal = item.price * item.qty;

                            total += itemTotal;

                            basketItems.innerHTML += `
        <div class="basket-item d-flex align-items-center mb-3 p-3 border rounded shadow-sm bg-white">
        <img src="/images/${item.image}" style="width:80px; height:80px; object-fit:cover; margin-right:20px; border-radius:8px;">
        <div class="flex-grow-1">
        <h5 class="mb-1">${item.name}</h5>
        <p class="text-muted mb-0">Price: ₹${item.price} x ${item.qty}</p>
        </div>
        <h5 class="fw-bold">₹${itemTotal}</h5>
        </div>`;

                            summaryItems.innerHTML += `
        <div class="d-flex justify-content-between mb-2">
        <span>${item.name} (x${item.qty})</span>
        <span>₹${itemTotal}</span>
        </div>`;

                        });

                        totalAmount.innerText = total;

                    }

                });
    </script>

}
